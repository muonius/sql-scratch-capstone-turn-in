select * from surveylimit 10;select question, count (distinct user_id) from surveygroup by question;select * from quizlimit 5;select * from home_try_onlimit 5;select * from purchaselimit 5; with funnels as (select q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'from quiz qleft join home_try_on hon q.user_id=h.user_idleft join purchase pon q.user_id=p.user_id)select number_of_pairs, count (*) as 'num_browse', sum(is_home_try_on) as 'num_home_try_on', sum(is_purchase) as 'number_purchase', 100*sum (is_home_try_on)/count (user_id) as '% of home try on', 100*sum (is_purchase)/sum(is_home_try_on) as '% of try on to purchase',100*sum (is_purchase)/count (user_id) as 'overall conversion'from funnels;with funnels as (select q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'from quiz qleft join home_try_on hon q.user_id=h.user_idleft join purchase pon q.user_id=p.user_id)select number_of_pairs,100*sum (is_purchase)/sum(is_home_try_on) as '% of try on to purchase'from funnelsgroup by number_of_pairs;select shape, count (shape) as 'num_shape'from quizgroup by shape;with style as (select shape, count (shape) as 'num_shape'from quizgroup by shape)select shape, num_shape, 100*num_shape/1000 as '%' from stylegroup by shape;select model_name, style, count (model_name) as 'num_model'from purchasegroup by model_name;with funnels as (select q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'from quiz qleft join home_try_on hon q.user_id=h.user_idleft join purchase pon q.user_id=p.user_id)select number_of_pairs,100*sum (is_purchase)/sum(is_home_try_on) as '% of try on to purchase'from funnelsgroup by number_of_pairs;select q.user_id,h.user_id is not null as 'is_home_try_on',h.number_of_pairs,p.user_id is not null as 'is_purchase'from quiz qleft join home_try_on hon q.user_id=h.user_idleft join purchase pon q.user_id=p.user_id;